angular.module("dojo",[]).provider("stamp",function(){this.$get=function(){var a={};return a.fromISOString=function(b,c){a._isoRegExp||(a._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/);var d=a._isoRegExp.exec(b),e=null;if(d){d.shift(),d[1]&&d[1]--,d[6]&&(d[6]*=1e3),c&&(c=new Date(c),array.forEach(array.map(["FullYear","Month","Date","Hours","Minutes","Seconds","Milliseconds"],function(a){return c["get"+a]()}),function(a,b){d[b]=d[b]||a})),e=new Date(d[0]||1970,d[1]||0,d[2]||1,d[3]||0,d[4]||0,d[5]||0,d[6]||0),d[0]<100&&e.setFullYear(d[0]||1970);var f=0,g=d[7]&&d[7].charAt(0);"Z"!=g&&(f=60*(d[8]||0)+(Number(d[9])||0),"-"!=g&&(f*=-1)),g&&(f-=e.getTimezoneOffset()),f&&e.setTime(e.getTime()+6e4*f)}return e},a.toISOString=function(a,b){var c=function(a){return 10>a?"0"+a:a};b=b||{};var d=[],e=b.zulu?"getUTC":"get",f="";if("time"!=b.selector){var g=a[e+"FullYear"]();f=["0000".substr((g+"").length)+g,c(a[e+"Month"]()+1),c(a[e+"Date"]())].join("-")}if(d.push(f),"date"!=b.selector){var h=[c(a[e+"Hours"]()),c(a[e+"Minutes"]()),c(a[e+"Seconds"]())].join(":"),i=a[e+"Milliseconds"]();if(b.milliseconds&&(h+="."+(100>i?"0":"")+c(i)),b.zulu)h+="Z";else if("time"!=b.selector){var j=a.getTimezoneOffset(),k=Math.abs(j);h+=(j>0?"-":"+")+c(Math.floor(k/60))+":"+c(k%60)}d.push(h)}return d.join("T")},a}}).provider("json",function(){this.$get=["stamp",function(stamp){djson={},djson.fromJson=function(js){return eval("("+js+")")},djson._escapeString=JSON.stringify,djson.toJsonIndentStr="	",djson.toJson=function(a,b){return JSON.stringify(a,function(a,b){if(b){var c=b.__json__||b.json;if("function"==typeof c)return c.call(b)}return b},b&&djson.toJsonIndentStr)};var json={};return json.resolveJson=function(a,b){function c(p,q,r,s,t,u){var v,w,x,y=e in p?p[e]:r;(e in p||void 0!==y&&s)&&(y=(h+y).replace(m,"$2$3"));var z=u||p;if(void 0!==y){if(i&&(p.__id=y),!b.schemas||p instanceof Array||!(x=y.match(/^(.+\/)[^\.\[]*$/))||(t=b.schemas[x[1]]),j[y]&&p instanceof Array==j[y]instanceof Array)z=j[y],delete z.$ref,delete z._loadObject,w=!0;else{var A=t&&t.prototype;A&&(o.prototype=A,z=new o)}j[y]=z,k&&(k[y]=b.time)}for(;t;){var B=t.properties;if(B)for(v in p){var C=B[v];C&&"date-time"==C.format&&"string"==typeof p[v]&&(p[v]=stamp.fromISOString(p[v]))}t=t["extends"]}var D=p.length;for(v in p){if(v==D)break;if(p.hasOwnProperty(v)){if(x=p[v],"object"==typeof x&&x&&!(x instanceof Date)&&"__parent"!=v)if(d=x[f]||g&&x[e],d&&x.__parent||p!=l&&(x.__parent=z),d){delete p[v];var E=d.toString().replace(/(#)([^\.\[])/,"$1.$2").match(/(^([^\[]*\/)?[^#\.\[]*)#?([\.\[].*)?/);if(j[(h+d).replace(m,"$2$3")]?d=j[(h+d).replace(m,"$2$3")]:(d="$"==E[1]||"this"==E[1]||""==E[1]?a:j[(h+E[1]).replace(m,"$2$3")])&&E[3]&&E[3].replace(/(\[([^\]]+)\])|(\.?([^\.\[]+))/g,function(a,b,c,e,f){d=d&&d[c?c.replace(/[\"\'\\]/,""):f]}),d)x=d;else if(!q){var F;F||l.push(z),F=!0,x=c(x,!1,x[f],!0,C),x._loadObject=b.loader}}else q||(x=c(x,l==p,void 0===y?void 0:n(y,v),!1,C,z!=p&&"object"==typeof z[v]&&z[v]));if(p[v]=x,z!=p&&!z.__isDirty){var G=z[v];z[v]=x,!w||x===G||z._loadObject||"_"==v.charAt(0)&&"_"==v.charAt(1)||"$ref"==v||x instanceof Date&&G instanceof Date&&x.getTime()==G.getTime()||"function"==typeof x&&"function"==typeof G&&x.toString()==G.toString()||!j.onUpdate||j.onUpdate(z,v,G,x)}}}if(w&&(e in p||z instanceof Array)){for(v in z)if(!(z.__isDirty||!z.hasOwnProperty(v)||p.hasOwnProperty(v)||"_"==v.charAt(0)&&"_"==v.charAt(1)||z instanceof Array&&isNaN(v)))for(j.onUpdate&&"_loadObject"!=v&&"_idAttr"!=v&&j.onUpdate(z,v,z[v],void 0),delete z[v];z instanceof Array&&z.length&&void 0===z[z.length-1];)z.length--}else j.onLoad&&j.onLoad(z);return z}b=b||{};var d,e=b.idAttribute||"id",f=this.refAttribute,g=b.idAsRef,h=b.idPrefix||"",i=b.assignAbsoluteIds,j=b.index||{},k=b.timeStamps,l=[],m=/^(.*\/)?(\w+:\/\/)|[^\/\.]+\/\.\.\/|^.*\/(\/)/,n=this._addProp,o=function(){};return a&&"object"==typeof a&&(a=c(a,!1,b.defaultId,!0),c(l,!1)),a},json.fromJson=function(str,args){function ref(a){var b={};return b[this.refAttribute]=a,b}try{var root=eval("("+str+")")}catch(e){throw new SyntaxError("Invalid JSON string: "+e.message+" parsing: "+str)}return root?this.resolveJson(root,args):root},json.toJson=function(a,b,c,d,e){function f(a,d,l){if("object"==typeof a&&a){if(a instanceof Date)return'"'+stamp.toISOString(a,{zulu:!0})+'"';var m=a.__id;if(m){if("#"!=d&&(g&&!m.match(/#/)||j[m])){var n=m;"#"!=m.charAt(0)&&(n=a.__clientId==m?"cid:"+m:m.substring(0,c.length)==c?m.substring(c.length):m);var o={};return o[i]=n,djson.toJson(o,b)}d=m}else a.__id=d,k[d]=a;j[d]=a,l=l||"";var p=b?l+djson.toJsonIndentStr:"",q=b?"\n":"",r=b?" ":"";if(a instanceof Array){var s=_.map(a,function(a,b){var c=f(a,h(d,b),p);return"string"!=typeof c&&(c="undefined"),q+p+c});return"["+s.join(","+r)+q+l+"]"}var t=[];for(var u in a)if(a.hasOwnProperty(u)){var v;if("number"==typeof u)v='"'+u+'"';else{if("string"!=typeof u||"_"==u.charAt(0)&&"_"==u.charAt(1))continue;v=djson._escapeString(u)}var w=f(a[u],h(d,u),p);if(void 0===w&&e.includeEmptyKeys===!0&&(w='" "'),"string"!=typeof w)continue;t.push(q+p+v+":"+r+w)}return"{"+t.join(","+r)+q+l+"}"}return djson.toJson(a)}e||(e={}),e.instance&&(a=e.instance);var g=this._useRefs,h=this._addProp,i=this.refAttribute;c=c||"";var j={},k={},l=f(a,"#","");if(!d)for(var m in k)delete k[m].__id;return l},json._addProp=function(a,b){return a+(a.match(/#/)?1==a.length?"":".":"#")+b},json.refAttribute="$ref",json._useRefs=!1,json.serializeFunctions=!1,json.serialize=function(a,b){var c;return b||(b={}),b.prettyPrint&&(c=!0),json.toJson(a,c,"",!1,b)},json}]}),Function.prototype.inherits=function(a){var b;return b=this,b=a.apply(b)},angular.module("ActiveResource",["ng","dojo"]).provider("ActiveResource",function(){this.$get=["ARBase",function(a){return ActiveResource={},ActiveResource.Base=a,ActiveResource}]}),angular.module("ActiveResource").provider("ARAPI",function(){this.$get=["ARHelpers","Mime",function(a,b){function c(a,c){var d,e=a.name.hyphenate(),f=e.toLowerCase(),g=f.pluralize(),h=c||"id";this.indexURL="",this.createURL="",this.showURL="",this.deleteURL="",this.updateURL="",this.set=function(a){return"/"!=a.slice(-1)&&(a+="/"),this.createURL=a+g,this.updateURL=this.showURL=this.deleteURL=a+g+"/:"+h,this.indexURL=a+g,this},this.updatePrimaryKey=function(a){return h=a,this.updateURL=this.updateURL,this},this.format=function(a){b.types.register(a),a.match(/\.\w+/)||(a="."+a),d=a;for(var c in this)c.match(/URL/)&&(_.each(b.types,function(a){var b=new RegExp("."+a);this[c]=this[c].replace(b,"")},this),this[c]+=d)}}return c}]}),angular.module("ActiveResource").provider("ARAssociation",function(){this.$get=["$injector","ARBelongsTo",function(a,b){function c(d,e,f,g){if(g.provider)var h=g.provider;else var h=f.classify();"BelongsTo"==d&&(this.foreignKey=g.foreignKey?g.foreignKey:f.singularize()+"_id",b(this,e,f,g)),this.klass=a.get(h),this.propertyName=f,this.type=d,c.cached[e.constructor.name.toLowerCase()+":"+f]=this}return c.cached={},c}]}).provider("ARBelongsTo",function(){this.$get=["ARAssociations","ARHelpers",function(a,b){function c(c,d,e){var f=void 0;Object.defineProperty(d,e,{enumerable:!0,get:function(){return f},set:function(e){if(void 0===e)return void(f=e);var g=b.getPrimaryKeyFor(d);if("String"==e.constructor.name||"Number"==e.constructor.name)c.klass.find(e).then(function(a){f=a;var b=d.constructor.name.pluralize().camelize(),c=f[b];d[g]&&c&&!_.include(c,d)&&c.push(d)});else if(c.klass.name==e.constructor.name){f=e;var h,i,j=a.get(e);_.each([j.hasMany,j.hasOne],function(a){_.each(a,function(a){a.klass==d.constructor&&(h=a,i=a.klass.name.camelize(),"hasMany"==h.type&&(i=i.pluralize()))})});var k=f[i];void 0!==d[g]&&k&&("hasMany"==h.type?_.include(k,d)||k.push(d):"hasOne"==h.type&&Object.defineProperty(f,i,{enumerable:!0,configurable:!0,value:d}))}}})}return c}]}).provider("ARAssociations",function(){this.$get=["$q",function(){function a(b){function c(b){var c=!0;_.each(this,function(a){a.klass==b.klass&&(c=!1)}),c&&this.push(b),"hasOne"==b.type&&(b.klass.prototype.find=function(){var c=a.get(b.klass).belongsTo,d={};return _.each(c,function(a){d[a.propertyName]=this[a.propertyName]},this),b.klass.find(d)})}var d=b.name.toLowerCase();this.belongsTo=[],this.hasMany=[],this.hasOne=[],this.belongsTo.add=c,this.hasMany.add=c,this.hasOne.add=c,a.cached[d]||(a.cached[d]=this)}return a.cached={},a.get=function(b){return model=b.klass?b.klass:b,"Function"!==model.constructor.name?model=model.constructor:model.new(),a.cached[model.name.toLowerCase()]},a.getBelongs=function(b,c){var d=a.get(b),e=void 0;return _.each(d.belongsTo,function(a){a.klass==c.constructor&&(e=a)}),e},a.getDependents=function(b,c){var d=a.getBelongs(b,c);return d},a}]}).provider("ARCollection",function(){this.$get=function(){function a(a,b){var c=b.name.toLowerCase(),d=[];return Object.defineProperty(d,"new",{enumerable:!1,value:function(b){return b||(b={}),b[c]=d[c],a.new(b)}}),Object.defineProperty(d,"$create",{enumerable:!1,value:function(b){return b||(b={}),b[c]=d[c],a.$create(b)}}),Object.defineProperty(d,"where",{enumerable:!1,value:function(b){return b||(b={}),b[c]=d[c],a.where(b)}}),Object.defineProperty(d,"find",{enumerable:!1,value:function(b){return b||(b={}),b[c]=d[c],a.find(b)}}),Object.defineProperty(d,"all",{enumerable:!1,value:function(b){return b||(b={}),b[c]=d[c],a.where(b)}}),Object.defineProperty(d,"first",{enumerable:!1,get:function(){return d[0]}}),Object.defineProperty(d,"last",{enumerable:!1,get:function(){return d.slice(-1)[0]}}),d}return a}}),String.prototype.downcase=function(){return this.toLowerCase()},angular.module("ActiveResource").provider("ARCache",function(){this.$get=function(){function a(){Object.defineProperty(this,"cache",{enumerable:!1,value:function(a,b){a&&void 0!==a[b]&&(a.constructor.cached[a[b]]=a)}}),Object.defineProperty(this,"isEmpty",{enumerable:!1,value:function(){return!Object.keys(this).length}}),Object.defineProperty(this,"length",{enumerable:!1,value:function(){return Object.keys(this).length}}),Object.defineProperty(this,"where",{enumerable:!1,value:function(a){return 0==Object.keys(a).length&&(a=void 0),_.where(this,a,this)}})}return a}}),angular.module("ActiveResource").provider("ARSerializer",function(){this.$get=["json","ARMixin","ARAssociations","ARHelpers","ARDeferred",function(a,b,c,d,e){function f(){function f(a){var e=b({},a,!1),f=c.get(a);return _.each(f.belongsTo,function(b){var c=b.foreignKey,f=d.getClassNameFor(b),g=a[f];if(g){var h=d.getPrimaryKeyFor(g),i=g[h];e[c]=i,e[f]=void 0}}),e}function i(a,b){var d=!1,e=c.get(b);return _.each(e.belongsTo,function(b){var c=b.foreignKey;(a[c]||a==c)&&(d=!0)}),d}this.serialize=function(b,c){var d=f(b);return a.serialize(d,c)},this.deserialize=function(a,b,c){var d,c;return d=a&&a.data?a.data:a,c||(c={lazy:!0}),i(d,b)?h(b,d,c):g(b,d,c).then(function(a){return b=a,e(b)})}}function g(a,b,c){function f(){return a.establishBelongsTo(),e(a)}if(c&&0==c.update)return e(a);a.update(b);var g=d.getPrimaryKeyFor(a);return a.constructor.cached.cache(a,g),a.validations.updateInstance(a),c.lazy?f():i(a).then(f)}function h(a,b,d){d&&0==d.update&&(d.update=!0);var f=[],h=c.get(a);return h.belongsTo.length>=1&&_.each(h.belongsTo,function(a){if(b[a.foreignKey]){var c=a.klass,e=c.name.camelize(),g=a.foreignKey,h=b[g],i={};for(var j in d)i[j]=d[j];d.overEager||(i.lazy=!0),f.push(function(c){a.klass.find(h,i).then(function(a){b[e]=a,delete b[g],c(null,b)})})}}),async.series(f,function(b,c){c=_.first(c),g(a,c,d)}),e(a)}function i(a){var b=[],f=c.get(a),g=[f.hasMany,f.hasOne];return _.each(g,function(e){_.each(e,function(e){var g=c.getDependents(e,a),h=g.foreignKey,i={},j=d.getPrimaryKeyFor(a);i[h]=a[j],b.push(function(b){e.klass.where(i,{lazy:!0}).then(function(c){_.each(c,function(c){if(_.include(f.hasMany,e)){var d=e.klass.name.pluralize().camelize();a[d].nodupush(c)}else{var d=e.klass.name.singularize().camelize();a[d]||(a[d]=c)}b(null,a)})})})})}),async.series(b,function(){}),e(a)}return f}]}),angular.module("ActiveResource").provider("ARHelpers",function(){this.$get=function(){return Object.defineProperty(Array.prototype,"nodupush",{enumerable:!1,configurable:!0,value:function(a){_.include(this,a)||this.push(a)}}),{getClassNameFor:function(a){return a.klass.name.camelize()},getPrimaryKeyFor:function(a){return"Function"==a.constructor?a.primaryKey:a.constructor.primaryKey}}}}),angular.module("ActiveResource").provider("ARMixin",function(){this.$get=function(){return function(a,b,c){function d(){a.hasOwnProperty(e)||(!function(){var b;Object.defineProperty(a,e,{enumerable:!0,get:function(){return b},set:function(a){b=a}})}(),a[e]=b[e])}"Function"==b.constructor.name&&(b=new b);for(var e in b)c?"function"!=typeof b[e]&&d():d();return a}}}),angular.module("ActiveResource").provider("ARDeferred",function(){this.$get=["$q",function(a){return function b(c,d){var b=a.defer();return d?b.reject(d):b.resolve(c),b.promise}}]}),angular.module("ActiveResource").provider("ARQuerystring",function(){this.$get=function(){var a={stringify:function(a){var b="";return _.map(a,function(a,c){b+=0==b.length?c+"="+a:"&"+c+"="+a}),b},parse:function(){}};return a}}),angular.module("ActiveResource").provider("ARParameterize",function(){this.$get=function(){return function(a,b){return a?b?a.replace(/\:\_*[A-Za-z]+/g,function(a){return a=a.replace(/\:*/,""),b[a]}):a:void 0}}}),angular.module("ActiveResource").provider("URLify",function(){this.$get=["ARParameterize","ARQuerystring",function(a,b){return function(c,d){if(c){if(!d)return c;var e="";return b.stringify(d)&&(e="?"+b.stringify(d)),c.match(/\[\:[A-Za-z]+\]/)?c=c.replace(/\[\:[A-Za-z]+\]/,e):c.match(/\:\_*[A-Za-z]+/)&&(c=a(c,d)),c}}}]}),angular.module("ActiveResource").provider("ARGET",function(){this.$get=["$http","ARDeferred","ARAssociations","ARHelpers","URLify","$q",function(a,b,c,d,e,f){function g(a,b,c){return a&&a.length>=1?_.first(c.noInstanceEndpoint?_.where(a,b):a):a}function h(a){return a}function i(a,b){var e,f,g=c.get(a);return g?(g=g.belongsTo,_.each(g,function(a){if(b[a.propertyName]){e=b[a.propertyName],f=a.propertyName;var c=a.foreignKey,g=d.getPrimaryKeyFor(b[a.propertyName]);b[c]=e[g],b[c]&&delete b[a.propertyName]}}),[e,b,f]):void 0}function j(a){var b=[];return a.replace(/\:[a-zA-Z_]+/g,function(a){b.push(a)}),b=_.map(b,function(a){return a.slice(1)})}function k(a,b){var c=j(a),d=!0;return _.each(c,function(a){void 0===b[a]&&(d=!1)}),_.each(b,function(a,b){_.include(c,b)||(d=!1)}),d}return function(b,c,d,j){var l,d,m,n=i(b,d);n&&(l=n[0],d=n[1],m=n[2]);var o={};if(k(c,d)?c=e(c,d):Object.keys(d).length&&(c=c.replace(/\/\:[a-zA-Z_]+/g,"").replace(/\:[a-zA-Z_]+/g,""),o.params=d),j.api===!1){var p=f.defer();return p.resolve(j.cached),p.promise}return a.get(c,o).then(function(a){var b=a.data;return m&&l&&(b&&b.push?_.each(b,function(a){a[m]=l}):b[m]=l),j.multi?h(b,d,j):g(b,d,j)})}}]}),angular.module("ActiveResource").provider("ARBase",function(){this.$get=["ARAPI","ARCollection","ARAssociation","ARAssociations","ARCache","ARSerializer","AREventable","ARValidations","$http","$q","$injector","ARDeferred","ARGET","ARMixin","URLify","ARHelpers",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(){function k(a){N.cached.cache(a,O)}function q(a){_.each(N.watchedCollections,function(b){_.remove(b,a)})}function r(a,b){var c=s(b);return!(!a[c]||a[c].constructor!=b)}function s(a){return a&&(a.klass||a.name)?a.klass?a.klass.name.camelize():a.name.camelize():void 0}function t(a){return _.include(F(N),a)}function u(a){return _.include(C(),a.camelize())}function v(a){return _.include(D(),a.camelize())}function w(a){return _.include(E(),a.camelize())}function x(a,b){("Number"==a.constructor.name||"String"==a.constructor.name)&&(a=void 0),a&&(this[b]=a)}function y(a,b,c,d){_.remove(a,function(a){var b=_.include(d,a[c]);return 0==b?(delete a.constructor.cached[a[c]],!0):void 0})}function z(a,b,c){var d,e,f;d=_.first(a),void 0!==d&&(e=d.constructor),void 0!==e&&(f=e.cached),_.each(b,function(b){var d;if(void 0!==f){var e={};e[c]=b[c],d=f.where(e)}d&&d.length?d[0].update(b):a.new(b)},this)}function A(a,b){var c=this[b.camelize()],d=_.first(c);if(!d)return z(c,a);var e=p.getPrimaryKeyFor(d),f=_.chain(a).map(function(a){return a[e]}).compact().unique().value();y(c,a,e,f),z(c,a,e,f)}function B(a,b){_.each(P.hasOne,function(c){if(c.klass.name==b.classify()){Object.defineProperty(this,b,{enumerable:!0,configurable:!0,value:c.klass.new(a)});var e=d.cached[c.klass.name.downcase()].belongsTo;_.each(e,function(a){a.klass==this.constructor&&(this[b][a.propertyName]=this)},this)}},this)}function C(){return _.map(P.belongsTo,function(a){return a.klass.name.camelize()})}function D(){return _.map(P.hasMany,function(a){return a.klass.name.camelize().pluralize()})}function E(){return _.map(P.hasOne,function(a){return a.klass.name.camelize()})}function F(a){var b=a.new(),c=Object.getOwnPropertyNames(b),d=[];for(var e in b)d.nodupush(e);_.each(c,function(a){d.nodupush(a)}),d.nodupush(O);var f=["establishBelongsTo","$save","update","$delete","associations","primaryKey","hasMany","hasOne","belongsTo","validate","$valid","$invalid","$errors","validations","validates"];return _.remove(d,function(a){return _.include(f,a)}),d}function G(a){void 0===a.validations&&a.validates({}),a.validate=function(b){return a.validations.validate(b,a)},a.validateIfErrored=function(b){a.$errors[b]&&a.validate(b,a)},Object.defineProperty(a,"$valid",{get:function(){return a.validate()}}),Object.defineProperty(a,"$invalid",{get:function(){return!a.$valid}}),Object.defineProperty(a,"$errors",{get:function(){return a.validations.$errors}}),a.clearErrors=function(b){a.validations.clearErrors(b)}}function H(a,b){a[O]=b[O]}function I(a,b,c){_.each(a[b],function(a){c[b].new(a)})}function J(a,b,c,e){var f=a[e.propertyName];if(f&&f.constructor.name==e.klass.name){var g=f,h=d.get(f).belongsTo;_.each(h,function(a){a.klass==c.constructor&&(f[a.propertyName]=c)})}else{var i,j=d.get(e).belongsTo;_.each(j,function(a){a.klass==c.constructor&&(i=a)}),a[b][i.propertyName]=c;var g=e.klass.new(a[b])}Object.defineProperty(c,b,{enumerable:!0,configurable:!0,value:g})}function K(a){_.each(Q,function(b){var c=a[b];_.each(c,function(a){a.$delete()})}),_.defer(function(){L(a),delete N.cached[a[O]]})}function L(a){_.each(P.hasMany,function(b){var c=a[b.klass.name.pluralize().camelize()],d=a.constructor.name.camelize();_.each(c,function(a){a[d]=void 0})}),_.each(P.belongsTo,function(b){var c=a[b.klass.name.camelize()];if(c){var d=a.constructor.name.pluralize().camelize();_.remove(c[d],a)}})}function M(a){var b=a;return a={},a[O]=b,a}var N=this;N.watchedCollections=[];var O="id";Object.defineProperty(N,"primaryKey",{configurable:!0,get:function(){return O},set:function(a){O=a,this.api.updatePrimaryKey(O)}});var P=new d(N),Q=[];this.api=new a(this),n(N,g),N.cached||(N.cached=new e),serializer=new f,N.prototype.toJSON=function(a){return N.prototype.serialize.call(this,a)},N.prototype.serialize=function(a){return serializer.serialize(this,a)},N.prototype.$save=function(a,b,c){a||(a=this),a&&a[O]&&!b?(b=o(N.api.updateURL,a),c!==!1&&(c=!0)):b||(b=N.api.createURL),N.emit("$save:called",a);var d=serializer.serialize(a);return a.$invalid?(N.emit("$save:fail",a),l(null,a)):(method=c?"put":"post",i[method](b,d).then(function(b){return serializer.deserialize(b,a).then(function(a){return N.emit("$save:complete",{data:b,instance:a}),l(a)})}))},N.prototype.$update=function(a){function b(){return c.$save(c,d,"put")}var c=this;N.emit("$update:called",{instance:c,data:a});var d=N.api.updateURL;if(d)return d.match(/\:\w+/)&&(d=d.replace(/\:\w+/,this[O])),a?c.update(a).then(function(a){return c=a,b()}):b()},N.prototype.update=function(a){N.emit("update:called",{data:a,instance:this});for(var b in a)v(b)?A.call(this,a[b],b):w(b)?B.call(this,a[b],b):u(b)?x.call(this,a[b],b):t(b)&&(this[b]=a[b]);var c=this;return serializer.deserialize(a,c,{lazy:!0,update:!1}).then(function(){return N.emit("update:complete",{data:a,instance:c}),l(c)})},N.$create=function(a){a||(a={}),N.emit("$create:called",a);var b=N.new(a);return b.establishBelongsTo(),b.$save().then(function(a){return b=a,k(b),l(b)})},N.new=function(a){if(a||(a={}),N.emit("new:called",a),"Number"==typeof a&&(a=M(a)),a&&this.cached[a[O]])return this.cached[a[O]];N.prototype.integer=function(b){var c=this,d={};d[b]={integer:{ignore:/\,/g}},c.validates(d),c[b]=a[b]},N.prototype.number=function(b){var c=this,d={};d[b]={numericality:{ignore:/\,/g}},c.validates(d),c[b]=a[b]},N.prototype.boolean=function(b){var c=this,d={};d[b]={"boolean":!0},c.validates(d),c[b]=a[b]},N.prototype.string=function(b){var c=this,d={};d[b]={string:!0},c.validates(d),c[b]=a[b]},N.prototype.computedProperty=function(b,c,d){var e=this;d||(d=[]),d.push||(d=[d]);var f;Object.defineProperty(e,b,{enumerable:!0,configurable:!0,get:function(){return f},set:function(){return f=c.apply(e)}}),_.each(d,function(c){var d,f=e.__lookupSetter__(c),g=e[c];Object.defineProperty(e,c,{enumerable:!0,configurable:!0,get:function(){return d},set:function(a){return void 0!==a&&"set"!=a&&(d=a),f&&(d==a?f():d=f()),e[b]="set",d}}),e[c]=a&&a[c]?a[c]:g})};var b=new this(a);return H(b,a),k(b),_.each(P.belongsTo,function(c){var d=s(c);a&&void 0!==a[d]&&(b[d]=a[d])}),_.each(P.hasMany,function(c){var d=c.klass.name.pluralize().camelize();b[d][this.name.camelize()]=b,void 0!==a[d]&&I(a,d,b)},this),_.each(P.hasOne,function(c){var d=c.propertyName;void 0!==a[c.propertyName]&&J(a,d,b,c)}),G(b),N.emit("new:complete",b),b},N.where=function(a,b){if(N.emit("where:called",a),"object"!=typeof a)throw"Argument to where must be an object";b||(b={lazy:!1,overEager:!1,api:!0});var c=N.cached.where(a);b.cached=c,b.multi=!0;var d=N.api.indexURL||N.api.showURL;return m(N,d,a,b).then(function(a){var c=[];for(var d in a){var e=N.new(a[d]);c.push(e),serializer.deserialize(a[d],e,b)}return N.watchedCollections.push(c),N.emit("where:complete",{instance:c,data:a}),c})},N.all=function(a){return N.emit("all:called"),N.where({},a).then(function(a){var b=j.defer();return b.resolve(a),N.emit("all:complete",a),b.promise})},N.find=function(a,b){var c;if(N.emit("find:called",a),("number"==typeof a||"string"==typeof a)&&(a=M(a)),"object"!=typeof a)throw"Argument to find must be an object";b||(b={lazy:!1}),b.forceGET||(c=_.first(N.cached.where(a)));var d=N.api.showURL||N.api.indexURL;return void 0!==c?(N.emit("find:complete",{instance:c,data:c,message:"Backend not queried. Found in cache"}),l(c)):m(N,d,a,b).then(function(a){var c=N.new(a);return N.emit("find:complete",{instance:c,data:a}),serializer.deserialize(a,c,b)})},N.prototype.$delete=function(){var a=this;N.emit("$delete:called",this);var b={},c={},d=N.api.deleteURL;return b[O]=a[O],-1!==N.api.deleteURL.indexOf("/:")?d=o(N.api.deleteURL,b):c={params:b},i.delete(d,c).then(function(b){if(200==b.status){if(q(a),N.emit("$delete:complete",{data:b,instance:a}),Q.length>=1)return K(a);L(a),delete N.cached[a[O]]}})},N.prototype.establishBelongsTo=function(){if(P.belongsTo.length)for(var a in P.belongsTo){var b=P.belongsTo[a].klass,c=s(b);if(r(this,b)){var d=this[c][this.constructor.name.pluralize().camelize()];d&&d.push?d.nodupush(this):d=this}}};var R;return Object.defineProperty(N.prototype,"validates",{enumerable:!1,value:function(a){Object.defineProperty(this,"validations",{enumerable:!1,configurable:!0,get:function(){return R},set:function(a){void 0===R&&(R=new h(a,this)),R.addValidations(a)}}),this.validations=a}}),N.prototype.hasMany=function(a,d){d||(d={});var e=new c("hasMany",this,a,d);P.hasMany.add(e),N[a.classify()]=e.klass,this[a]=new b(e.klass,N),this[a][N.name.camelize()]=this},N.prototype.hasOne=function(a,b){b||(b={});var e=new c("hasOne",this,a,b);P.hasOne.add(e),this[a]||Object.defineProperty(this,a,{enumerable:!1,configurable:!0,value:e.klass.new()});var f=d.getBelongs(e.klass,this);this[a][f.propertyName]=this},N.prototype.belongsTo=function(a,b){b||(b={});var d=new c("BelongsTo",this,a,b);P.belongsTo.add(d)},N.dependentDestroy=function(a){"Array"!=a.constructor.name&&(a=[a]);for(var b in a)Q.push(a[b])},N}return q}]}),angular.module("ActiveResource").provider("AREventable",function(){this.$get=function(){function a(){function a(a,c){return a in b.handlers||(b.handlers[a]=[]),b.handlers[a].push(c),this}var b={handlers:{}};Object.defineProperty(this,"emit",{enumerable:!0,value:function(a){if(b.handlers[a]){for(var c=Array.prototype.slice.call(arguments,1),d=0,e=c.length;e>d;d++)b.handlers[a][d].apply(this,c);return b}}}),this.before=function(b,c){return a(b+":called",c)},this.after=function(b,c){return a(b+":complete",c)},this.fail=function(b,c){return a(b+":fail",c)}}return a}}),angular.module("ActiveResource").provider("Mime",function(){this.$get=[function(){return types=["json"],types.register=function(a){a=a.replace(/\./g,""),types.nodupush(a)},{types:types}}]}),angular.module("ActiveResource").provider("ARValidations",function(){this.$get=["$q",function(){function a(a,b){function c(){return function(a){return void 0===a||null===a?!1:"String"==a.constructor.name?!!(a&&a.length||"object"==typeof a):void 0!==a}}function d(a){return function(b,c,d){return a(b,c,d)===!0?!!(b&&b.length||"object"==typeof b):!0}}function e(){return function(a){return!a}}function f(){return function(a){return void 0===a||""===a||null===a?!0:/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,6}$/.test(a)}}function g(){return function(a){return void 0===a||""===a||null===a?!0:/(^\d{5}$)|(^\d{5}-{0,1}\d{4}$)/.test(a)}}function h(a){return function(b){return void 0===b||""===b||null===b?!0:a.test(b)}}function i(a){return function(b){if(void 0===b||""===b||null===b)return!0;if(!a.in)throw"Inclusion validator must specify 'in' attribute.";var c=!1;return a.in.forEach(function(a){a==b&&(c=!0)}),c}}function j(a){return function(b){if(void 0===b||""===b||null===b)return!0;if(!a.from)throw"Exclusion validator must specify 'from' attribute.";var c=!0;return a.from.forEach(function(a){a==b&&(c=!1)}),c}}function k(a){return function(b){return void 0===b||""===b||null==b?!0:b.length>=a[0]&&b.length<=a[a.length-1]}}function l(a){return function(b){return void 0===b||""===b||null===b?!0:b.length>=a}}function m(a){return function(b){return void 0===b||""===b||null===b?!0:b.length<=a}}function n(a){return function(b){return void 0===b||""===b||null===b?!0:String(b).length==a}}function o(){return function(a){return w(a)?!0:1==a}}function p(){return function(a,c){return confirmationName=c+"Confirmation",confirmationField=b[confirmationName],a==confirmationField}}function q(a){return function(b){return b?(b=String(b),a.ignore&&(b=b.replace(a.ignore,"")),!isNaN(Number(b))):!0}}function r(a){return function(b){return b?"Array"==b.constructor.name?!1:"Object"==b.constructor.name?!1:(b=String(b),b.match(/\./)?!1:(a.ignore&&(b=b.replace(a.ignore,"")),!isNaN(Number(b)))):!0}}function s(){return function(a){return void 0===a||""===a||null===a?!0:!(a!==!0&&a!==!1&&"true"!==a&&"false"!==a)}}function t(){return function(a){return void 0===a||""===a||null===a?!0:"Array"===a.constructor.name?!1:"Object"===a.constructor.name?!1:(a=a.toString(),_.isString(a))}}function u(a){return function(b,c,d){var e=d[a];return e?e&&e.length>=1?_.all(e,function(a){return a.$valid}):e.$valid:!0}}function v(a){return function(){return function(b,c,d){return void 0===b||""===b||null===b?!0:a(b,c,d)}}}function w(a){return a===!1?!1:!a}function x(a){var b;return b=void 0===a?A:A[a],void 0!==b?("Array"==b.constructor.name&&(b=_.zipObject([a],b)),b):void 0}function y(a,b,c){var d=c.split("."),e=b;_.each(d,function(a){e&&(e=e[a])});var f=a(e,c,b);return void 0===f?!1:f===!1?!1:!0}function z(a,b){function c(a,b,d,i,j){if(f(d[a]))return void h(d[a],b,i,j);if(e(d[a]))return d=d[a],keys=Object.keys(b),void keys.forEach(function(a){nestedValue=b[a],c(a,nestedValue,d,i,j)});if(g(d[a])){if("message"==a)return;if(!b.validates)throw"Custom validators must provide a validates key containing a Boolean function."}h(v(b.validates),b,i,j)}function d(a){return Object.prototype.toString.call(a)}function e(a){return"[object Object]"===d(a)}function f(a){return"[object Function]"===d(a)}function g(a){return void 0===a}function h(a,b,c,d){var e=function(c,d,e){return b.validates&&(b=b.validates),a(b)(c,d,e)?!0:!1};e.message=d.message?d.message:b.message?b.message:a.message(b),i.push(e)}var i=[];for(var j in a)c(j,a[j],B,b,a[j]);return i}var A={};this.$errors={},c.message=function(){return"Can't be blank"},e.message=function(){return"Can't be defined"},f.message=function(){return"Is not a valid email address"},g.message=function(){return"Is not a valid zip code"},h.message=function(){return"Is not the proper format"},i.message=function(a){return lastVal="or "+a.in.slice(-1),joinedArray=a.in.slice(0,-1),joinedArray.push(lastVal),list=joinedArray.join(joinedArray.length>=3?", ":" "),"Must be included in "+list},j.message=function(a){return lastVal="or "+a.from.slice(-1),joinedArray=a.from.slice(0,-1),joinedArray.push(lastVal),list=joinedArray.join(joinedArray.length>=3?", ":" "),"Must not be "+list},k.message=function(a){var b=a[0],c=a.slice(-1);return"Must be between "+b+" and "+c+" characters"},l.message=function(a){return"Must be at least "+a+" characters"},m.message=function(a){return"Must be no more than "+a+" characters"},n.message=function(a){return"Must be exactly "+a+" characters"},o.message=function(){return"Must be accepted"},p.message=function(){return"Must match confirmation field"},q.message=function(){return"Must be a number"},r.message=function(){return"Must be an integer"},s.message=function(){return"Must be true or false"},t.message=function(){return"Must be text"},u.message=function(a){return a.classify()+" invalid"};var B={presence:c,requiredIf:{requiredIf:d},absence:e,format:{email:f,zip:g,regex:h},inclusion:i,exclusion:j,length:{"in":k,min:l,max:m,is:n},acceptance:o,confirmation:p,numericality:q,integer:r,"boolean":s,string:t,association:u};for(var C in a)A[C]=new z(a[C],C);this.clearErrors=function(a){var b=x(a);for(var a in b)delete this.$errors[a]},this.validate=function(a,b){var c=x(a);for(var a in c)_.each(A[a],function(c){if(y(c,b,a)){if(!this.$errors[a])return;_.remove(this.$errors[a],function(a){return a==c.message}),0===this.$errors[a].length&&delete this.$errors[a]}else this.$errors[a]||(this.$errors[a]=[]),this.$errors[a].nodupush(c.message)},this);return 0===Object.keys(this.$errors).length},this.updateInstance=function(a){b=a},this.addValidations=function(a){for(var b in a)A[b]?(A[b].push(new z(a[b],b)),A[b]=_.flatten(A[b])):A[b]=new z(a[b],b)}}return a}]});var simpleForm=angular.module("simpleForm",["ActiveResource"]);simpleForm.directive("form",function(){return{restrict:"E",require:"^form",compile:function(){return{pre:function(a,b,c,d){function e(){return c["for"]?c["for"]+"Form":""}function f(a,b){if("hasOwnProperty"===a)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",b)}d.$name=c.name||e()||c.ngForm,d.$fields={},d.$addControl=function(a){f(a.$name,"input"),a.$name&&(d.$fields[a.$name]=a,d[a.$name]=a)}}}}}}),simpleForm.directive("ngModel",["$compile",function(){return{restrict:"A",require:["^ngModel","^form"],compile:function(){return{post:function(a,b,c,d){{var e,f=d[0];d[1]||nullFormCtrl}f.$name=c.name||c.ngModel||"unnamedInput",$modelname=c.ngModel.replace(/\.\w{0,}/g,""),a.$watch($modelname,function(a){function b(a){e.$errors[a]&&f.$setValidity(a,!1)}function d(a){e.$errors[a]||f.$setValidity(a,!0)}if(e=a){fieldNames=_.without(Object.getOwnPropertyNames(e),"validate","$valid","$invalid","$errors","validateIfErrored");var g=angular.copy(e.validate);e.validate=function(a){var f=c.ngModel.replace(/\w{0,}\./,"");return g.call(e,a),d(f),b(f),0===Object.keys(e.$errors).length}}})}}}}}]);